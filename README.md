# 日志挖掘项目 (Log Mining Project)

本项目旨在演示如何利用**开源大语言模型 (LLM)** 的自然语言推理能力，通过 **API 调用** 对系统日志进行自动化分析和异常诊断。

## 技术栈

* **核心技术**: **OpenRouter API**（统一接口）
* **核心模型**: **MiniMax M2 (free)** (开源 MoE 模型，优化于 Agentic 工作流和推理)
* **框架**: **Python**, **LangChain** (用于简洁地封装 API 调用和管理消息格式)
* **依赖管理**: **python-dotenv** (用于安全管理 API Key)
* **任务**: 日志异常诊断与原因分析

## 项目结构

项目采用模块化设计，代码组织清晰，便于维护和扩展：

```
log-mining/
├── config.py              # 配置文件：存放所有配置常量和系统提示词
├── llm_client.py          # LLM客户端模块：负责初始化和管理LLM客户端
├── diagnosis.py           # 日志诊断模块：负责日志的诊断和结果解析
├── statistics.py          # 统计报告模块：负责生成统计报告和结果分析
├── log_processor.py       # 主程序：协调各个模块，完成日志分析的完整流程
├── requirements.txt       # 依赖包列表
├── sample.log            # 示例日志文件
└── README.md             # 项目说明文档
```

### 模块说明

- **config.py**: 集中管理所有配置项，包括API密钥、模型名称、文件路径、系统提示词等
- **llm_client.py**: 封装LLM客户端的初始化逻辑，提供统一的客户端接口
- **diagnosis.py**: 实现日志诊断功能，包括LLM调用和结果解析
- **statistics.py**: 实现统计报告生成功能，包括数据统计和报告格式化
- **log_processor.py**: 主程序入口，负责协调各个模块完成完整的分析流程

## 功能特性

### ✅ 已实现功能

1. **日志智能诊断**
   - 使用 LLM 自动分析每条日志的严重程度
   - 识别错误、警告、正常等不同级别的日志
   - 提供详细的诊断结论和潜在原因分析

2. **统计报告功能** ⭐ 新增
   - 自动统计各严重程度的日志数量和占比
   - 生成可视化的统计摘要报告
   - 识别关键错误并给出处理建议
   - 输出文件：
     - `diagnosis_results.json` - 原始诊断结果
     - `statistics_report.json` - 统计报告（包含分布和摘要）
     - `structured_results.json` - 结构化结果（包含严重程度字段）

### 🚧 计划实现功能

- 过滤和搜索功能（按严重程度、关键词、时间范围）
- 进度显示功能（显示分析进度条）
- 导出功能（支持CSV格式）
- 可视化报告（HTML报告带图表）
- 批量处理功能（一次处理多个日志文件）
- 错误聚合功能（合并相似错误）

## 如何运行（API 调用方式）

本项目通过调用 OpenRouter 平台上的高性能开源 LLM 来实现实际的日志分析。

### 1. 环境准备

请使用 pip 安装所需的依赖库：

```bash
pip install -r requirements.txt